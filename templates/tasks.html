{% extends "base.html" %}

{% block title %}Tarefas - Sistema de Tarefas{% endblock %}

{% block content %}
<div class="tasks-header">
    <h2>Gerenciar Tarefas</h2>
    <a href="{{ url_for('create_task') }}" class="btn btn-primary">Nova Tarefa</a>
</div>

<div class="filters">
    <h3>Filtros</h3>
    <div class="filter-buttons">
        <a href="{{ url_for('tasks', status='all') }}" class="filter-btn {% if status_filter == 'all' %}active{% endif %}">
            Todas
        </a>
        <a href="{{ url_for('tasks', status='pendente') }}" class="filter-btn {% if status_filter == 'pendente' %}active{% endif %}">
            Pendentes
        </a>
        <a href="{{ url_for('tasks', status='em_andamento') }}" class="filter-btn {% if status_filter == 'em_andamento' %}active{% endif %}">
            Em Andamento
        </a>
        <a href="{{ url_for('tasks', status='concluida') }}" class="filter-btn {% if status_filter == 'concluida' %}active{% endif %}">
            Concluídas
        </a>
    </div>
</div>

<div class="tasks-container">
    {% if tasks %}
    <table class="tasks-table">
        <thead>
            <tr>
                <th>Título</th>
                <th>Descrição</th>
                <th>Status</th>
                <th>Responsável</th>
                <th>Data de Vencimento</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for task in tasks %}
            <tr>
                <td>{{ task.title }}</td>
                <td>{{ task.description|truncate(50) if task.description else 'Sem descrição' }}</td>
                <td>
                    <span class="status-badge status-{{ task.status }}">
                        {{ task.status|replace('_', ' ')|title }}
                    </span>
                </td>
                <td>{{ task.assignee.username }}</td>
                <td>{{ task.due_date.strftime('%d/%m/%Y') if task.due_date else 'Não definida' }}</td>
                <td>
                    <a href="{{ url_for('edit_task', task_id=task.id) }}" class="btn btn-small">Editar</a>
                    <a href="{{ url_for('delete_task', task_id=task.id) }}" class="btn btn-small btn-danger" onclick="return confirm('Tem certeza que deseja excluir esta tarefa?')">Excluir</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="no-tasks">Nenhuma tarefa encontrada. <a href="{{ url_for('create_task') }}">Crie uma agora!</a></p>
    {% endif %}
</div>
{% endblock %}